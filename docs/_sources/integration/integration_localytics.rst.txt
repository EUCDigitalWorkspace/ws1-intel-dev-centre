.. _integrate_localytics:

Localytics Integration Guide
----------------------------

This topic describes how to integrate Apteligent with
`Localytics <http://www.localytics.com>`_.
Localytics is the leading mobile engagement platform. They give companies insights and tools to improve their mobile app acquisition, engagement and retention efforts.  This integration allows companies to pull Apteligent performance data into Localytics and allow product managers and marketers to:

* Create segments of users that have a poor app experience
* Drive campaigns to target users at risk of churning
* Understand how performance is impacting business metrics like app usage, retention, and funnel conversion rates

This document will guide you through the process of activating sending Apteligent events into Localytics through a few additional lines of code in the SDK.

Requirements
============

Before you start the integration process, please make sure you have the following:

* Implemented the :ref:`Apteligent SDK <downloads>` (requires v5.6.1 of the iOS SDK) in the mobile app
* Implemented the `Localytics SDK <https://docs.localytics.com/dev/>`_ in the mobile app

Implementation
==============

The Apteligent SDK will create a notification that fires when the SDK knows that a crash occurred.  On iOS, when the user loads the app after a crash occurred, this notification will fire.  The notification will contain four pieces of information:

* Crash Name: The name of the crash (i.e., NSRangeException)
* Crash Reason: More details on why the crash occurred (i.e., "\***\ \-[__NSArrayM objectAtIndex:]:\ index 18446744073709551615 beyond bounds for empty array")
* Crash Date: The date and time at which the crash occurred
* Crash View: A list of the view controllers that were loaded at the time of the crash

Sending a Crash Event to Localytics (iOS)
####################################################

..  note::
	Make sure the Localytics SDK is initialized *before* Crittercism, otherwise the crash event will not be sent.  

To send these crash events to Localytics, add two lines of code:

1. Register an Observer to Capture the Apteligent Event

.. code-block:: objc

	[[NSNotificationCenter defaultCenter] addObserver:self
	    selector:@selector(crashDidOccur:)
	        name:@"CRCrashNotification" 
	      object:nil];

2. Send an Event to Localytics Upon Notification

.. code-block:: objc

	- (void)crashDidOccur:(NSNotification *)notification {
	    // Send Event to Localytics
	    [Localytics tagEvent:@"Crittercism Crash" attributes:notification.userInfo];
	} 

.. include:: ../shared/support_include.txt
