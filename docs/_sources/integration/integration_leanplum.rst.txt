.. _integrate_leanplum:

Leanplum Integration Guide
----------------------------

This topic describes how to integrate Apteligent with
`Leanplum <http://www.leanplum.com>`_.
Leanplum is a mobile marketing platform that drives app engagement and ROI. This integration allows companies to pull Apteligent performance data into Leanplum and allow product managers, analysts, and marketers to:

* Understand how performance is impacting business metrics like app usage, retention, and churn
* Create audiences of app users to engage through in-app and push messages -- eg, to apologize, let them know a fix is on the way.
* Detect is app is having an outage - don't send push notification. 

This document will guide you through the process of activating sending Apteligent events into Leanplum through a few additional lines of code in the SDK.

Requirements
============

Before you start the integration process, please make sure you have the following in the mobile app:

* Implemented the :ref:`Apteligent SDK <downloads>` (requires v5.6.1 of the iOS SDK and v5.8.0 of the Android SDK)
* Implemented the `Leanplum SDK <https://www.leanplum.com/docs#/setup>`_

Implementation
==============

The Apteligent SDK will create a notification that fires when the SDK knows that a crash occurred.  On iOS, when the user loads the app after a crash occurred, this notification will fire.  The notification will contain four pieces of information:

* Crash Name: The name of the crash (i.e., NSRangeException)
* Crash Reason: More details on why the crash occurred (i.e., "\***\ \-[__NSArrayM objectAtIndex:]:\ index 18446744073709551615 beyond bounds for empty array")
* Crash Date: The date and time at which the crash occurred
* Crash View: A list of the views that were active at the time of the crash

Sending a Crash Event to Leanplum (iOS)
####################################################

..  note::
	Make sure the Leanplum SDK is initialized *before* Crittercism, otherwise the crash event will not be sent.  

To send these crash events to Leanplum, add two lines of code:

1. Register an Observer to Capture the Apteligent Event

.. code-block:: objc

	[[NSNotificationCenter defaultCenter] addObserver:self
	    selector:@selector(crashDidOccur:)
	    name:@"CRCrashNotification" object:nil];

2. Send an Event to Leanplum Upon Notification

.. code-block:: objc

	- (void) crashDidOccur:(NSNotification*)notification {
	// Send Event to Leanplum
	[Leanplum track:@"ApteligentCrashEvent" withParameters:notification.userInfo];
	} 


.. include:: ../shared/support_include.txt
